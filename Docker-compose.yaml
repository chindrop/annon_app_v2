version: "3.4"
services:
  web:
    container_name: "blackbird_flask"
    build: app
    command: flask run --host=0.0.0.0
    ports:
      - "5000:5000"
    image: "blackbird_image"
    env_file:
      - app/.env
    environment:
      - FLASK_CONFIGURATION=${FLASK_CONFIGURATION}

  db:
    container_name: "blackbird_postgres"
    image: postgres
    restart: always
    volumes:
      - db-data:/var/lib/postgresql/data
    env_file:
      - app/.env
    ports:
      - "5432:5432"
  
  pgadmin:
    container_name: "blackbird_pgadmin"
    image: dpage/pgadmin4:6.7
    env_file:
      - app/.env
    ports:
     - "8080:80"
    volumes:
     - pgadmin-data:/var/lib/pgadmin
    depends_on: 
     - db

volumes:
  db-data:
  pgadmin-data: